# Feature Specification: 店家與菜單管理系統

**Feature Branch**: `001-store-menu-management`  
**Created**: 2025年11月22日  
**Status**: Draft  
**Input**: User description: "首頁提供輸入店家與菜單資訊，包括新增、列表、編修和刪除功能"

## Clarifications

### Session 2025-11-22

- Q: 營業時間欄位的輸入格式和驗證規則？ → A: 使用結構化時間範圍格式，例如「週一至週五 11:00-14:00, 17:00-21:00；週六日休息」，文字欄位輸入，最多 100 字
- Q: 各欄位的字數上限？ → A: 店家名稱 100 字、地址 200 字、菜單項目名稱 50 字、菜單描述 200 字、營業時間 100 字
- Q: JSON 檔案的儲存位置和命名方式？ → A: 在專案根目錄下建立 Data 資料夾，使用固定檔名 stores.json 儲存所有店家資料
- Q: 店家和菜單項目的 ID 生成方式？ → A: 使用自動遞增整數 ID（從 1 開始），系統自動管理並確保唯一性
- Q: 新增店家時菜單項目的最少數量要求？ → A: 必須至少提供一個菜單項目，確保資料完整性

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 新增店家與菜單資訊 (Priority: P1)

系統管理員需要能夠新增新的餐廳店家資訊到系統中，包含店家基本資料和菜單項目，以便讓使用者可以從這些店家訂購餐點。

**Why this priority**: 這是系統的核心功能，沒有店家資料就無法進行後續的訂餐流程。這是建立整個系統資料基礎的第一步。

**Independent Test**: 可以透過開啟首頁，點擊「新增店家」功能，填寫完整的店家資訊表單並提交，確認資料成功儲存並顯示確認訊息來進行測試。

**Acceptance Scenarios**:

1. **Given** 使用者在首頁點擊「店家列表」選單，**When** 點擊「新增店家」按鈕，**Then** 系統顯示店家資訊輸入表單，包含店名、地址、聯絡電話類型（市話/行動電話）、聯絡電話號碼、菜單項目（名稱、價格、描述）、營業時間等欄位
2. **Given** 使用者填寫完整的店家資訊，**When** 點擊提交按鈕，**Then** 系統驗證所有必填欄位已填寫、電話號碼僅含數字、菜單價格為正整數或零、菜單項目不超過 20 筆、店家不重複（店名+電話+地址組合唯一），將資料儲存至 JSON 檔案，顯示成功確認訊息，並自動記錄新增時間
3. **Given** 使用者未填寫必填欄位（店名、地址、聯絡電話），**When** 點擊提交按鈕，**Then** 系統顯示錯誤訊息，指出哪些欄位為必填且尚未填寫
4. **Given** 使用者輸入的電話號碼包含非數字字元，**When** 點擊提交按鈕，**Then** 系統顯示「電話號碼僅能輸入數字」的錯誤訊息
5. **Given** 使用者新增菜單項目時未填寫菜名或價格，**When** 點擊提交按鈕，**Then** 系統顯示菜單項目必填欄位的錯誤訊息
6. **Given** 使用者輸入的菜單價格為負數或包含小數點，**When** 點擊提交按鈕，**Then** 系統顯示「價格必須為正整數或零」的錯誤訊息
7. **Given** 使用者嘗試新增超過 20 個菜單項目，**When** 點擊新增更多菜單按鈕，**Then** 系統阻止新增並顯示「菜單項目已達上限 20 筆」的訊息
8. **Given** 系統中已存在相同店名、電話和地址的店家，**When** 使用者嘗試提交重複的店家資訊，**Then** 系統顯示「此店家已存在（店名、電話、地址完全相同）」的錯誤訊息，不允許新增
9. **Given** 使用者填寫店家資訊但未新增任何菜單項目，**When** 點擊提交按鈕，**Then** 系統顯示「至少需要新增一個菜單項目」的錯誤訊息
10. **Given** 使用者輸入超過字數上限的內容（店名 >100 字、地址 >200 字、菜名 >50 字、描述 >200 字、營業時間 >100 字），**When** 嘗試提交，**Then** 系統顯示超出字數限制的錯誤訊息

---

### User Story 2 - 瀏覽店家列表 (Priority: P1)

使用者需要能夠查看所有已新增的店家清單，並透過搜尋和篩選功能快速找到想要的店家，以便選擇訂餐或進行店家資訊維護。

**Why this priority**: 列表功能是檢視所有店家資料的入口，也是進行編修和刪除操作的前置步驟，與新增功能同等重要。

**Independent Test**: 可以在系統中新增數筆店家資料後，開啟店家列表頁面，確認所有店家都正確顯示，並測試搜尋功能是否能正確篩選結果。

**Acceptance Scenarios**:

1. **Given** 系統中已有多筆店家資料，**When** 使用者從首頁點擊「店家列表」，**Then** 系統顯示所有店家的基本資訊（店名、地址、電話、營業時間）
2. **Given** 使用者在列表頁面，**When** 在搜尋框輸入店家名稱的關鍵字，**Then** 系統即時篩選並顯示符合的店家
3. **Given** 使用者在列表頁面，**When** 點擊某個店家項目，**Then** 系統顯示該店家的詳細資訊，包含完整菜單
4. **Given** 系統中沒有任何店家資料，**When** 使用者開啟店家列表，**Then** 系統顯示「目前沒有店家資料」的訊息，並提供「新增店家」的連結

---

### User Story 3 - 編修店家資訊 (Priority: P2)

系統管理員需要能夠更新已存在的店家資訊，例如更改營業時間、調整菜單價格或新增菜單項目，以保持資料的正確性和即時性。

**Why this priority**: 店家資訊會隨時間變動（如價格調整、營業時間變更），編修功能確保系統資料保持最新，但相較於新增和查看功能，可以稍後實作。

**Independent Test**: 可以從店家列表選擇一筆資料，進入編輯模式，修改部分欄位後儲存，確認資料更新成功且修改時間正確記錄。

**Acceptance Scenarios**:

1. **Given** 使用者在店家列表頁面，**When** 點擊某個店家的「編輯」按鈕，**Then** 系統顯示預先填入該店家資訊的編輯表單
2. **Given** 使用者修改了店家的部分資訊，**When** 點擊儲存按鈕，**Then** 系統更新 JSON 檔案中的資料，記錄修改時間，並顯示成功訊息
3. **Given** 使用者清空了必填欄位的內容，**When** 點擊儲存按鈕，**Then** 系統顯示驗證錯誤，不允許儲存
4. **Given** 使用者在編輯過程中，**When** 點擊取消按鈕，**Then** 系統返回列表頁面且不儲存任何變更

---

### User Story 4 - 刪除店家資訊 (Priority: P3)

系統管理員需要能夠刪除不再營業或錯誤建立的店家資料，以維持系統資料的整潔性。

**Why this priority**: 刪除功能重要但使用頻率較低，且可以在前三個功能穩定後再實作，不影響系統的核心價值。

**Independent Test**: 可以從店家列表選擇一筆測試資料，執行刪除操作，確認資料從列表中移除且 JSON 檔案中的對應記錄已刪除。

**Acceptance Scenarios**:

1. **Given** 使用者在店家列表頁面，**When** 點擊某個店家的「刪除」按鈕，**Then** 系統顯示確認對話框，詢問是否確定刪除
2. **Given** 系統顯示刪除確認對話框，**When** 使用者點擊「確認」，**Then** 系統從 JSON 檔案中移除該筆資料，重新整理列表，並顯示刪除成功訊息
3. **Given** 系統顯示刪除確認對話框，**When** 使用者點擊「取消」，**Then** 系統關閉對話框，不執行刪除操作
4. **Given** 使用者嘗試刪除最後一筆店家資料，**When** 確認刪除，**Then** 系統成功刪除並顯示「目前沒有店家資料」的訊息

---

### User Story 5 - 首頁顯示與導航 (Priority: P1)

使用者進入系統時需要清楚了解這是訂餐系統，並能看到當前時間和主要功能選單，以便快速導航到需要的功能。

**Why this priority**: 首頁是使用者的入口點，必須提供清晰的系統定位和導航，與核心功能同等重要。

**Independent Test**: 可以開啟系統首頁，確認訂餐系統標題、即時時間顯示、以及主選單（店家列表、訂購餐點）都正確呈現。

**Acceptance Scenarios**:

1. **Given** 使用者開啟系統，**When** 進入首頁，**Then** 系統清楚顯示「訂餐系統」標題
2. **Given** 使用者在首頁，**When** 查看頁面，**Then** 系統顯示使用者當地的即時時間（格式：yyyy/MM/dd HH:mm:ss），且每秒自動更新
3. **Given** 使用者在首頁，**When** 查看選單，**Then** 系統顯示兩個主要選項：「店家列表」和「訂購餐點」
4. **Given** 使用者在首頁，**When** 點擊「店家列表」，**Then** 系統導航到店家列表頁面
5. **Given** 使用者在首頁，**When** 點擊「訂購餐點」，**Then** 系統顯示該功能按鈕（目前僅作為占位，未來擴充）

---

### Edge Cases

- 當使用者在編輯店家資訊時，另一個使用者同時也在編輯同一筆資料，如何處理資料衝突？（註：對於練習用的小型系統，採用「最後寫入者勝出」的簡單策略）
- 當 JSON 儲存檔案損毀或格式錯誤時，系統如何處理？（應顯示友善錯誤訊息，建議備份檔案）
- 當使用者輸入超長的店家名稱或描述時，UI 如何呈現？（應設定合理的字數上限並在 UI 中妥善處理顯示）
- 當使用者快速連續點擊提交按鈕時，會不會產生重複的店家資料？（應實作防重複提交機制）
- 當使用者試圖新增第 21 個菜單項目時，系統如何阻止？（應在 UI 層面限制新增按鈕或顯示警告）
- 當搜尋關鍵字包含特殊字元時，搜尋功能是否正常運作？（應進行適當的字元處理）
- 當使用者編輯店家資訊時修改了店名、電話或地址，導致與其他店家重複，如何處理？（應檢查並阻止更新，除非是編輯同一筆資料）
- 當使用者複製貼上電話號碼時包含空格、破折號或括號，系統如何處理？（應在驗證時移除或提示僅接受純數字）
- 當使用者在價格欄位輸入 "0" 時，這是否為有效價格？（是，零為有效價格，可能代表免費或試吃）
- 當使用者輸入的營業時間格式不正確或不清楚時，系統是否需要驗證？（採用自由文字輸入，僅限制字數上限 100 字，由使用者確保格式合理）
- 當 JSON 檔案不存在時，系統首次執行如何處理？（自動建立 Data 資料夾和空的 stores.json 檔案）
- 當刪除店家後，該店家的 ID 是否可以重複使用？（否，ID 持續遞增，已刪除的 ID 不再使用）
- 當使用者編輯店家時刪除所有菜單項目，是否允許？（否，必須至少保留一個菜單項目）

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系統必須提供首頁，清楚標示為「訂餐系統」，並顯示使用者當地的即時時間（格式：yyyy/MM/dd HH:mm:ss）
- **FR-002**: 系統必須在首頁提供主選單，包含「店家列表」和「訂購餐點」兩個選項
- **FR-003**: 系統必須提供新增店家功能，包含以下必填欄位：店家名稱（最多 100 字）、店家地址（最多 200 字）、聯絡電話類型（市話或行動電話）、聯絡電話號碼、營業時間（最多 100 字，建議格式：週一至週五 11:00-14:00, 17:00-21:00）
- **FR-004**: 系統必須允許在新增店家時同時新增菜單項目，每個菜單項目包含：菜名（必填，最多 50 字）、價格（必填）、描述（選填，最多 200 字），菜單項目數量最少 1 筆、最多 20 筆
- **FR-005**: 系統必須在儲存店家資料時自動記錄新增時間和修改時間
- **FR-006**: 系統必須驗證必填欄位，未填寫時不允許提交並顯示明確的錯誤訊息
- **FR-007**: 系統必須驗證電話號碼僅包含數字（0-9），不允許包含空格、破折號、括號或其他字元
- **FR-007-1**: 系統必須驗證菜單價格為正整數或零（0），不允許負數或小數
- **FR-007-2**: 系統必須在新增店家前檢查重複性，若店家名稱、電話號碼、地址三者完全相同則視為重複，不允許新增並顯示明確錯誤訊息
- **FR-007-3**: 系統必須限制每個店家的菜單項目最多 20 筆，達到上限時阻止新增更多項目
- **FR-007-4**: 系統必須驗證欄位長度不超過限制：店家名稱 100 字、地址 200 字、菜單項目名稱 50 字、描述 200 字、營業時間 100 字
- **FR-007-5**: 系統必須驗證新增店家時至少包含一個菜單項目，未提供時顯示明確錯誤訊息
- **FR-008**: 系統必須將店家和菜單資料儲存為本地 JSON 檔案格式，檔案位置為專案根目錄下的 Data/stores.json
- **FR-008-1**: 系統必須在首次執行時自動建立 Data 資料夾和 stores.json 檔案（若不存在）
- **FR-008-2**: 系統必須為每個店家和菜單項目自動生成唯一的自動遞增整數 ID，從 1 開始
- **FR-009**: 系統必須提供店家列表頁面，顯示所有已新增的店家基本資訊（店名、地址、電話類型與號碼、營業時間）
- **FR-010**: 系統必須在店家列表提供即時搜尋功能，可根據店家名稱進行篩選
- **FR-011**: 系統必須允許使用者點擊店家項目查看詳細資訊，包含完整菜單
- **FR-012**: 系統必須提供編輯功能，允許修改已存在的店家和菜單資訊
- **FR-013**: 系統必須在儲存編輯後的資料時更新修改時間
- **FR-014**: 系統必須提供刪除功能，允許移除店家資料
- **FR-015**: 系統必須在執行刪除操作前顯示確認對話框，防止誤刪
- **FR-016**: 系統必須在成功執行新增、編輯或刪除操作後顯示明確的確認訊息
- **FR-017**: 系統必須在沒有店家資料時顯示友善的空狀態訊息，並引導使用者新增店家
- **FR-018**: 系統必須提供取消功能，允許使用者在新增或編輯過程中放棄變更
- **FR-019**: UI 必須簡潔明瞭，確保使用者能輕鬆操作各項功能
- **FR-020**: 系統必須實作防重複提交機制，避免快速連續點擊產生重複資料

### Key Entities

- **店家 (Store)**: 代表一個餐廳或店家，包含基本資訊：
  - ID：自動遞增整數（系統自動生成，從 1 開始）
  - 店名：最多 100 字
  - 地址：最多 200 字
  - 聯絡電話類型：市話或行動電話
  - 聯絡電話號碼：純數字
  - 營業時間：最多 100 字（建議格式：週一至週五 11:00-14:00, 17:00-21:00）
  - 新增時間：系統自動記錄
  - 修改時間：系統自動記錄
  - 菜單項目清單：1-20 筆
  - 店家的唯一性由店名、電話號碼、地址三者組合決定
  - 資料儲存位置：Data/stores.json

- **菜單項目 (MenuItem)**: 代表店家提供的單一餐點或商品，包含項目資訊：
  - ID：自動遞增整數（系統自動生成，從 1 開始）
  - 菜名：最多 50 字
  - 價格：正整數或零
  - 描述：最多 200 字（選填）
  - 所屬店家關聯：外鍵參照店家 ID

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 使用者能在 3 分鐘內完成新增一個店家（包含 5 個菜單項目）的完整流程
- **SC-002**: 首頁的即時時間顯示必須每秒更新，時間誤差不超過 1 秒
- **SC-003**: 店家列表的搜尋功能必須在使用者輸入後 0.5 秒內顯示篩選結果
- **SC-004**: 系統能正確儲存和讀取至少 100 筆店家資料而不發生效能問題（頁面載入時間不超過 2 秒）
- **SC-005**: 所有表單驗證錯誤訊息必須清楚指出問題欄位和修正方式，使用者第一次操作的成功率達 90%
- **SC-006**: 刪除操作的確認對話框必須出現，防止 100% 的誤刪案例
- **SC-007**: 資料操作（新增、編輯、刪除）後的確認訊息必須在 1 秒內顯示
- **SC-008**: UI 設計必須讓使用者無需教學即可找到並完成主要功能（新增、查看、編輯、刪除），直覺性測試通過率達 85%
- **SC-009**: 系統必須在提交前正確驗證所有欄位（電話純數字、價格正整數或零、菜單 1-20 筆、店家不重複、欄位長度限制），驗證準確率達 100%
- **SC-010**: 使用者嘗試新增重複店家時，系統必須在 1 秒內完成重複性檢查並顯示明確的錯誤訊息
- **SC-011**: 系統必須正確生成和管理自動遞增 ID，確保所有店家和菜單項目的 ID 唯一且不重複
